$define(["wgt_util","jquery.formValidate","wgt/frontPlugin/DatePicker-LQ/js/jquery.datePicker","https://pv.sohu.com/cityjson?ie=utf-8"],function(e,a,k,t,n){var L=function(){var e={msgAndDescription:{box:"header",label:"",val:""},messageCategoryName:{box:"SubHeadBox",label:"nameS",val:"SubHeadA"},description:{box:"AssistLabelBox",label:"nameT",val:"AssistLabelA"},content:{box:"ContentBox",label:"nameA",val:"content"},name:{box:"NameBox",label:"nameB",val:"nameM"},sex:{box:"SexBox",label:"nameC",val:"sex"},tele:{box:"TelephoneBox",label:"nameD",val:"telephone"},mobile:{box:"PhoneBox",label:"nameE",val:"phone"},fax:{box:"FaxBox",label:"nameG",val:"fax"},mail:{box:"EmailBox",label:"nameH",val:"email"},addr:{box:"AddressBox",label:"nameI",val:"address"},postCode:{box:"ZipCodeBox",label:"nameJ",val:"ZipCode"},submitDom:{box:"CommonBtnA",label:"",val:""},captchas:{box:"CaptchasBoxA",label:"nameX",val:"EntryInput"}};return e},o=function(){var e={custom_1:{box:"e_box-000",label:"e_name-000",val:"e_input-001",unit:"e_name-000"},custom_2:{box:"e_box-000",label:"e_name-000",val:"e_text-001"},custom_3_1:{box:"e_box-000",label:"e_name-000",val:"e_radio-001"},custom_3_2:{box:"e_box-000",label:"e_name-000",val:"e_checkbox-001"},custom_3_3:{box:"e_box-000",label:"e_name-000",val:"e_droplist-001"}};return e},F={name:"",sex:"gender",mobile:"mobile",tele:"tele",fax:"fax",mail:"email",addr:"detailedAddress",postCode:"zipCode",portraitPath:"headPic"};function h(e,a,t,n){var i=e.ITEM_LIST;if(null!=i&&"null"!=i&&""!=i){var s=e.DATA_TYPE,o=e.SUB_TYPE,l=e.compConfig,r=e.i18nMap,p=e.itemDisplayJson,d=e.itemShowJson,u=e.userDataJson,c=k(".p_MessageForm .categoryName",a).val(),m=k(".p_MessageForm",a),_=function(e,a,t,n,i,s){var o=null,l=s[t],r="";null!=i[t]&&"undefined"!=i[t]&&(r=" "+i[t]+" ");if(1==l){var p=z(null,t,n,"box"),d="e_box "+p+" p_"+t+r;(o=j(d)).append(e),o.append(a)}return o}(function(e,a,t,n,i){var s=null,o=L().messageCategoryName.box,l=L().messageCategoryName.label,r=L().messageCategoryName.val;if(1==i[o]){var p=T(o,e),d="e_box "+p+" "+a[o]+" p_"+o;s=j(d);var u=null,c=e["imessageCategoryName"+k(".formId").val()+"sep"];if(c=null==c?"":c,1==i[l]){var m=T(l,e),_="e_title "+m+" "+a[l]+" p_"+l;u=j(_);var f=j("font"),v=U("iconfont");f.append(v),f.append(E("messageCategoryName",n.messageCategoryName)+c),u.append(f)}var h=null;if(1==i[r]){var b=T(r,e),x="e_title "+b+" "+a[r]+" p_"+r,h=j(x),g=j("font");valIDom=U("iconfont"),g.append(valIDom),g.append(t),h.append(g)}s.append(u),s.append(h)}return s}(l,p,c,r,d),function(e,a,t){var n=null,i=L().description.box,s=L().description.label,o=L().description.val;if(1==t[i]){var l=T(i,e),r="e_box "+l+" "+a[i]+" p_"+i;n=j(r);var p=null,d=e["idescription"+k(".formId").val()+"sep"];if(d=null==d?"":d,1==t[s]){var u=T(s,e),c="e_title "+u+" "+a[s]+" p_"+s;p=j(c);var m=j("font"),_=U("iconfont");m.append(_),m.append(E("description",i18nMap.description)+d),p.append(m)}var f=null;if(1==t[o]){var v=T(o,e),h="e_HtmlEditor "+v+" "+a[o]+" p_"+o,b=j(h),x=j("font categoryDescContent");f=U("iconfont"),x.append(f),b.append(x)}n.append(p),n.append(b)}return n}(l,p,d),L().msgAndDescription.box,l,p,d);m.append(_);for(var f=e.formId,v=0;v<i.length;v++){x(m,i[v].item,s,o,l,p,t,v,a,d,r,u,f,e)}if(n){var h=function(e,a,t,n){if(n[L().captchas.box]+""=="false")return"";var i=null==n.nameX?"true":n.nameX,s=null==a.nameX?"":a.nameX,o=null==e.captchasTipsFlag?"":e.captchasTipsFlag,l=[];l.push("<div>"),l.push('<div class="e_box d_CaptchasBoxA p_CaptchasBoxA js-validate-group">'),l.push('  <div class="e_box '+Y(e,"es_GuideBox","e_box-000")+' p_GuideBox">'),"true"==i.toString()&&(l.push('  <div class="e_title d_nameX '+s+' p_nameX">'),l.push('    <div class="font"><i class="iconfont"></i><span>验证码：</span></div>'),l.push("  </div>"));l.push("  </div>"),l.push('  <div class="e_box '+Y(e,"es_EntryBox","e_box-001")+' p_EntryBox">'),l.push('    <div class="e_input p_EntryInput">'),"true"==o&&l.push('      <i class="iconfont forward"></i>');l.push('      <input type="text"  class="InputText js_captchas_input" name="captchas" maxlength="5">'),l.push('      <i class="iconfont last"></i>'),l.push("    </div>"),l.push("  </div>"),l.push('  <div class="e_image '+Y(e,"es_imageB","e_image-001")+' d_imageB p_imageB js_captchas_img_box">'),l.push('    <img width="100%" height="100%" class="js_captchas_img">'),l.push("  </div>"),l.push('  <div class="e_title '+Y(e,"es_AssistLabelB","e_AssistLabel-001")+' d_AssistLabelB p_AssistLabelB js_captchas_img_box">'),l.push('    <div class="font js_change_captchas_img"><i class="iconfont"></i>'+t.change+"</div>"),l.push("  </div>"),l.push("</div>"),l.push("</div>");var r=e["icaptcha"+k(".formId").val()+"sep"];r=null==r?"":r;var p=k(l.join(""));p.find(".p_CaptchasBoxA").addClass(T(L().captchas.box,e)).addClass(a.CaptchasBoxA),p.find(".p_nameX").addClass(T(L().captchas.label,e)),p.find(".p_nameX span").html(E("captchasTitle",t.captchasTitle)+r),"true"==o&&p.find("input",".p_EntryInput").attr("placeholder",t.captchasTips);return p.find(".p_EntryInput").addClass(T("EntryInput",e)),p.find(".js_captchas_img_box").show(),p.html()}(l,p,r,d);m.append(h)}var b=function(e,a,t,n){var i=null,s=L().submitDom.box;if(1==n[s]){var o=T(s,e),l="e_btn "+o+" "+a[s]+" p_"+s;(i=j(l)).attr("title",t.submitButtonDescription);var r=j("font"),p=U("iconfont");r.append(p),r.append(E("submitButtonLabel",t.submitButtonLabel)),i.append(r)}return i}(l,p,r,d);m.append(b)}}function x(e,a,t,n,i,s,o,l,r,p,d,u,c,m){var _,f,v,h,b,x,g,T,y,I,C=a,D=C.fixedFlag,E=C.checkFlag,B=C.code,N=a.code,S=L()[N];if(!H(N)){var P=null,M=null,O=null;if(0==D?(P="i"+C.id+"L",M="i"+C.id+"V",O="i"+C.id):1==D&&null!=S&&"undefined"!=S&&(P=S.label,M=S.val,O=S.box),null!=P&&null!=M&&null!=O){var A=function(e,a,t,n,i,s,o,l,r,p){var d=null,u=i.fixedFlag,c="",m="";t=0==u?(c=w(i,o,l,"box"),"i"+i.id):(c="d_"+(m=t),"f"+p+m);var _=" "+s[t]+" ";if(r[t]){var f=z(i,m,n,"box"),v="e_box "+f+_+c+" p_"+t+" js-validate-group";d=j(v),i.dataType==o.OPTION.ID&&(i.subType==l.OPTION.PULLDOWN_SINGLE.ID?d.attr("plugname","select"):i.subType!=l.OPTION.RADIO.ID&&i.subType!=SUB_TYPE.OPTION.CHECKBOX.ID||d.attr("plugname","option"),d.attr("name","item_"+i.id)),d.append(e),d.append(a);var h="";if(1==i.dataType){var b=k('<label for="item_'+i.id+'"></label>');6==i.subType?(h=j("e_icon "+Y(n,"es_DateIcon_"+i.id,"e_icon-000")+" d_DateIcon p_DateIcon_"+i.id),h=b.append(h)):7==i.subType&&(h=j("e_icon "+Y(n,"es_DateIconA_"+i.id,"e_icon-000")+" d_DateIconA p_DateIconA_"+i.id),h=b.append(h))}if(d.append(h),i.dataType==o.SINGLE_TEXT.ID&&i.subType==l.SINGLE_TEXT.DIGITAL.ID){var x=(y=n,I="i"+(T=i).id+"U",C=j("e_title "+z(T,I,y,"unit")+" p_"+I),D=j("font"),E=U("iconfont"),D.append(E),D.append(T.unit),C.append(D),C);if(null!=x){var g=n["i"+i.id+"UnitFlag"];"true"==g&&d.append(x)}}}var T,y,I,C,D,E;return d}((f=P,h=s,b=t,x=n,g=p,T=j("e_box "+z(_=C,"GuideBox",v=i,"box")+" p_GuideBox"),y=function(e,a){if(e.mustInputFlag+""=="0")return"";var t=j("e_icon "+z(e,"star",a,"icon")+" p_star"),n=j("font"),i=U("iconfont");return n.append("*"),n.append(i),t.append(n),t}(_,v),I=function(e,a,t,n,i,s,o){var l=e.fixedFlag,r=null,p="";null!=n&&null!=n[a]&&"undefined"!=n[a]&&(p=" "+n[a]+" ");var d=o[a],u="";null!=l&&0==l&&(null!=(d=t[a])&&"undefined"!=d||(d=!0),u=w(e,i,s,"label"));if(1==d||"true"==d){var c=t["i"+e.id+"sep"],m=z(e,a,t,"label"),_="e_title "+m+p+u+" p_"+a;r=j(_);var f=j("font"),v=U("iconfont");f.append(v),f.append(e.name),f.append(c),r.append(f)}return r}(_,f,v,h,b,x,g),T.append(y),T.append(I),T),function(i,e,a,t,n,s,o,l,r,p){var d=null,u=i.fixedFlag,c=i.id,m="";null!=u&&"undefined"!=u&&0==u&&(t="i"+c+"V",i.dataType==e.OPTION.ID&&i.subType==a.OPTION.RADIO.ID&&(m=" d_CustomValue"));var _=z(i,t,n,"val"),f="e_input "+_+" p_"+t,v="e_text "+_+" p_"+t,h="e_radio "+_+m+" p_"+t,b="e_checkbox "+_+" d_checkboxA p_"+t;if(i.dataType==e.SINGLE_TEXT.ID)if(null!=u&&"undefined"!=u&&0==u&&(f+=" d_input"),G(i.dataType,i.subType,e,a)){var x=k('<input type="text" class="InputText"/>');x.attr("id","item_"+c),x.attr("name","item_"+c),x.attr("readonly","readonly"),x.data("datatype",i.dataType),x.data("subtype",i.subType);var g=n["i"+i.id+"DateFormat"];null!=g&&""!==g||(g="yyyy-MM-dd");var T=n["i"+i.id+"TimeFormat"];i.subType==a.SINGLE_TEXT.DATE.ID?x.attr("onclick","datePicker({dateFmt:'"+g+"'})"):(null!=T&&""!==T||(T="HH:mm"),g=g+" "+T,x.attr("onclick","datePicker({dateFmt:'"+g+"','skin':'whyGreen'})")),d=q(f,x,"input")}else{var y=function(e,a,t,n){var i=e.subType;{if(i!=a.SINGLE_TEXT.MOBILE.ID&&i!=a.SINGLE_TEXT.TELE.ID)return"-1";var s=V(e,"InterCodeFlag"),o=n[s];if(!o||"false"==o.toString())return"-1";var l=V(e,"InterCode"),r=t[l];return null!=r&&null!=r||(r=t.interCode),r}}(i,a,p,n);y=null!=y&&"-1"!=y?y:"";var I=k('<input type="text" class="InputText"/>');I.attr("id","item_"+c),I.attr("name","item_"+c),I.attr("maxlength",i.maxLength),I.data("datatype",i.dataType),I.data("subtype",i.subType),k(I).val(y),function(e,a,t){if(1!=e.fixedFlag||!t)return;if("name"==e.code){var n=null,i=t.customerType;if(null==(n="ent"==i?t.contactName:t.name))return;a.val(n)}else{var s=F[e.code];if(null!=s){var o=t[s];if(null==o)return;a.val(o)}}}(i,I,l),d=q(f,I,"input",X(n,c))}else if(i.dataType==e.MULTI_TEXT.ID){null!=u&&"undefined"!=u&&0==u&&(v+=" d_textarea");var I=k('<textarea class="Text" />');I.attr("id","item_"+c),I.attr("name","item_"+c),I.data("datatype",i.dataType),I.data("subtype",i.subType),I.attr("maxlength",i.maxLength),d=q(v,I,"textarea")}else if(i.dataType==e.OPTION.ID){var C=-1;0==u?C=n["i"+i.id+"SelectValue"]:1==u&&"sex"==i.code&&((C=function(e,a){if("sex"!=e.code||!a)return;var t,n=F[e.code];if(null!=n&&(userData=a[n],e.options&&""!=e.options)){var i=e.options.split("\n");"0"==userData?userData="男":"1"==userData&&(userData="女");for(var s=0;s<i.length;s++)if(userData==i[s]){t=s+1;break}}return t}(i,l))||(C=n.sexSelectValue));var D=k('<input type="hidden" name="item_"'+i.id+"/>"),E=function(e){for(var a=e.split("\n"),t=new Array,n=0;n<a.length;n++)t[n]={id:n+1+"",name:a[n]+""};return t}(i.options);if(i.subType==a.OPTION.PULLDOWN_SINGLE.ID){var B=jQuery.extend(!0,{},{eleConfig:{style:"",zstyle:"",cstyle:"",choose:"choose"},selectId:"",name:"",data:[],hasImg:!1,placeholder:"",handler:function(e,a){}}),m="";null!=u&&"undefined"!=u&&0==u&&(m=" d_select ");var N="e_droplist "+_+" "+m+" p_"+t,S=k('<div class="'+N+'"></div>');B.name="select_"+i.id;for(var P=new Array,M=0;M<E.length;M++){var O={};O.id=E[M].id,O.name=E[M].name,O.value=E[M].id,O.isdef=M==C-1,O.location="",P.push(O)}B.data=P,B.hasImg=!1,B.handler=function(e,a){var t=e.value,n=k("input[name='item_"+i.id+"']");k(n).val(t)};var A=S.simplySelect(B);A.build();var L="i"+i.id+"TipsFlag",w=n[L];w+""=="true"&&A.setMess(i.tips),S.append(D),d=S}else i.subType!=a.OPTION.RADIO.ID&&i.subType!=SUB_TYPE.OPTION.CHECKBOX.ID||(i.subType==a.OPTION.RADIO.ID?d=k(function(e,a,t,n){var i=[];if(!t||""==t)return;n&&""!=n||(n="1");i.push('<div class="e_box '+Y(compConfig,"es_CustomValueBox","e_box-000")+' d_CustomValueBox p_CustomValueBox">');for(var s=0;s<t.length;s++)i.push(R(e,a,t[s],n));return i.push("</div>"),i.join("")}(i,h,E,C)):i.subType==a.OPTION.CHECKBOX.ID&&(d=k(function(e,a,t){var n=[];if(!t||""==t)return;n.push('<div class="e_box '+Y(compConfig,"es_checkboxContainerA","e_box-000")+' d_checkboxContainerA p_checkboxContainerA">');for(var i=0;i<t.length;i++)n.push(K(e,a,t[i]));return n.push("</div>"),n.join("")}(i,b,E))));i.subType!=a.OPTION.RADIO.ID&&i.subType!=a.OPTION.CHECKBOX.ID&&(D.attr("name","item_"+i.id),D.attr("value","1"),null!=d&&(d instanceof Array?d.push(D):d.append(D)))}if(null!=d){var j=X(n,c);"true"==j&&(i.dataType!=e.SINGLE_TEXT.ID||G(i.dataType,i.subType,e,a)?i.dataType==e.MULTI_TEXT.ID?d.find("textarea").attr("placeholder",i.tips):d.attr("placeholder",i.tips):d.find("input").attr("placeholder",i.tips))}return d}(C,t,n,M,i,0,0,u,0,d),O,i,C,s,t,n,p,c);e.append(A),console.log(a,"aaaaaaaaa"),"mobile"==B&&1==E&&e.append('<div class="e_box e_box-000 p_sendBox js-validate-group"><div class="e_box e_box-000 p_GuideBox"><div class="e_title e_name-000 p_nameE"><div class="font"><i class="iconfont"></i>'+m.i18nNew.phoneCode+'</div></div></div><div class="e_input e_input-001 p_phoneCode"><i class="iconfont forward"></i><input type="text" class="InputText js_sendMessage_input" placeholder="'+m.i18nNew.phoneCode+'" check-result="true"><i class="iconfont last"></i></div><div class="e_btn p_senSMSMessage" title="'+m.i18nNew.sendCode+'"><div class="font"><i class="iconfont"></i><span>'+m.i18nNew.sendCode+'</span></div></div><div class="e_btn p_timers item_hide" title="'+m.i18nNew.sendCode+'"><div class="font"><i class="iconfont"></i><span>60</span>'+m.i18nNew.times+'</div></div><div class="e_LoginPrompt e_LoginPrompt-001 p_LoginPrompt p_errBox item_hide"><i class="iconfont icon-error"></i><i class="text-error"><div class="font">'+m.i18nNew.isEmpty+"</div></i></div></div>"),"mail"==B&&1==E&&e.append('<div class="e_box e_box-000 p_sendBox p_mailBox js-validate-group"><div class="e_box e_box-000 p_GuideBox"><div class="e_title e_name-000 p_nameE"><div class="font"><i class="iconfont"></i>'+m.i18nNew.mailCode+'</div></div></div><div class="e_input e_input-001 p_phoneMailCode"><i class="iconfont forward"></i><input type="text" class="InputText js_sendMessage_input js_sendMailMessage" placeholder="'+m.i18nNew.mailCode+'" check-result="true"><i class="iconfont last"></i></div><div class="e_btn p_senSMSMessage p_senMailessage" title="'+m.i18nNew.sendCode+'"><div class="font"><i class="iconfont"></i><span>'+m.i18nNew.sendCode+'</span></div></div><div class="e_btn p_timers item_hide" title="'+m.i18nNew.sendCode+'"><div class="font"><i class="iconfont"></i><span>60</span>'+m.i18nNew.times+'</div></div><div class="e_LoginPrompt e_LoginPrompt-001 p_LoginPrompt p_errBox item_hide"><i class="iconfont icon-error"></i><i class="text-error"><div class="font">'+m.i18nNew.isEmpty+"</div></i></div></div>")}}}function X(e,a){var t=e["i"+a+"TipsFlag"];return null==t&&(t="true"),t}function G(e,a,t,n){if(e==t.SINGLE_TEXT.ID){if(a==n.SINGLE_TEXT.DATE.ID)return"date";if(a==n.SINGLE_TEXT.DATE_TIME.ID)return"dateTime"}return null}function V(e,a){var t=e.fixedFlag,n="";return 1==t?n=e.code+a:0==t&&(n="i"+e.id+a),n.toString()}function w(e,a,t,n){var i="";return e.dataType==a.SINGLE_TEXT.ID?"label"==n?i=" d_InputName":"box"==n&&(i=" d_CustomInput"):e.dataType==a.MULTI_TEXT.ID?"label"==n?i=" d_TextareaName":"box"==n&&(i=" d_CustomTextarea"):e.dataType==a.OPTION.ID&&(e.subType==t.OPTION.PULLDOWN_SINGLE.ID?"label"==n?i=" d_nameO":"box"==n&&(i=" d_customA"):e.subType!=t.OPTION.RADIO.ID&&e.subType!=SUB_TYPE.OPTION.CHECKBOX.ID||(e.subType==t.OPTION.RADIO.ID?"label"==n?i=" d_CustomName":"box"==n&&(i=" d_custom"):e.subType==t.OPTION.CHECKBOX.ID&&("label"==n?i=" d_nameP":"box"==n&&(i=" d_SelectMore")))),i}function j(e){var a=k("<div></div>");return a.addClass(e),a}function U(e){var a=k("<i></i>");return a.addClass(e),a}function H(e){return"messageCategoryName"==e||"description"==e||"captcha"==e}function T(e,a){return a["es_"+e]}function z(e,a,t,n){var i=t["es_"+a];if(null!=e){var s=e.fixedFlag;H(e.code)||0==s&&(null!=i&&"undefined"!=i&&""!=i||(i=function(e,a){var t,n=e.dataType,i=e.subType;1==n||2==n?t="custom_"+n:3==n&&(t="custom_"+n+"_"+i);return o()[t][a]}(e,n)))}return i}function q(e,a,t,n){n=n||"false";var i=k('<div class="'+e+'"></div>');return"input"==t&&"true"==n&&i.append('<i class="iconfont forward"></i>'),i.append(a),"input"==t&&i.append('<i class="iconfont last"></i>'),i}function R(e,a,t,n){var i=[],s="item_"+e.id,o="";return n==t.id&&(o=" checked "),i.push('<div class="'+a+'">'),i.push('  <label class="option">'),i.push('    <div class="shape">'),i.push('      <input class="radio" type="radio" name="'+s+'" value="'+t.id+'"'+o+">"),i.push('      <i class="iconfont first"></i>'),i.push("    </div>"),i.push('    <div class="font"><i class="iconfont last"></i>'+t.name+"</div>"),i.push("  </label>"),i.push("</div>"),i.join("")}function K(e,a,t){var n=[],i="item_"+e.id;return n.push('<div class="'+a+'">'),n.push('  <label class="option">'),n.push('    <div class="shape">'),n.push('      <input class="checkbox" type="checkbox" name="'+i+'" value="'+t.id+'">'),n.push('      <i class="iconfont first"></i>'),n.push("    </div>"),n.push('    <div class="font"><i class="iconfont last"></i>'+t.name+"</div>"),n.push("  </label>"),n.push("</div>"),n.join("")}var s=[{methodname:"mobileValidate",pattern:"",ajax:function(e){return"zh_CN"!=window.tenant.language&&"zh_HN"!=window.tenant.language||!!/^1\d{10}$/.test(e)},ajaxMsg:""},{methodname:"telPhoneValidate",pattern:"",ajax:function(e){if(!/^[\d\-()、]{7,32}$/.test(e))return!1;for(var a,t=[],n=0;a=e.charAt(n);n++)if("("==a)t.push(a);else if(")"==a&&"("!=t.pop())return!1;return!t.length},ajaxMsg:""},{methodname:"validateCaptas",pattern:"",ajax:_,ajaxMsg:""},{methodname:"validateMessageCaptas",pattern:"",ajax:f,ajaxMsg:""}];function _(e){var a=!1;return""==e||k.ajax({url:"/captcha/check?code="+e,dataType:"json",async:!1,success:function(e){"0"==e.code&&(a=!0)}}),a}function f(e,n,i,a){console.log(e,n,i,a,"asdasdasdasdsad");var s=a.params.i18nNew,o=!1;if(""==e)return o;var t={};return t.compType=a.id,t.verifyType=i,t.verifyValue=e,k.ajax({url:"/comp/member/checkVerifyCode",type:"POST",data:t,async:!1,success:function(e){console.log(e,"验证验证码");e=JSON.parse(e);var a=k(".p_sendBox",n).eq(0),t=k(".p_mailBox",n);2016==e.status||2019==e.status?("SMS"==i&&(a.find(".p_errBox").addClass("item_hide"),a.find(".p_phoneCode").removeClass("error")),"EMAIL"==i&&(t.find(".p_errBox").addClass("item_hide"),t.find(".p_phoneMailCode").removeClass("error")),o=!0):("SMS"==i&&(a.find(".p_errBox").removeClass("item_hide").find(".font").text(s.codeError),a.find(".p_phoneCode").addClass("error")),"EMAIL"==i&&(t.find(".p_errBox").removeClass("item_hide").find(".font").text(s.codeError),t.find(".p_phoneMailCode").addClass("error")))}}),o}function b(e,a){k.bubbleTooltip({mess:a,style:"e_PromptFail-001",zstyle:"p_fail",type:k.bubbleTooltip.getType().FAIL,funClose:function(){},scope:e})}var v=function(i,s,o){var e=k.param({realIP:returnCitySN.cip})+"&"+k(".msgForm",s).serialize();k.ajax({url:"/message/ajax/save.do",type:"post",dataType:"json",data:e,success:function(e){var a,t,n;"1"==e.status?(t=s,n=i,k.bubbleTooltip({mess:n,style:"e_PromptSucc-001",zstyle:"p_succ",type:k.bubbleTooltip.getType().SUCCESS,funClose:function(){},scope:t}),1==o.linkToFlag?setTimeout(function(){"_blank"==o.submitBtn_target?window.location.href=o.submitBtn_url:"_self"==o.submitBtn_target&&(window.location.href=o.submitBtn_url)},2e3):setTimeout(function(){window.location=location},2e3)):"-1"==e.status?b(s,i18nMap.captchasErrorPrompt):"-3"==e.status?b(s,function(){var e="";switch(tenant.language){case"zh_CN":e="为避免相同数据重复提交，建议您一分钟后再试。";break;case"zh_HN":e="為避免相同數據重複提交，建議您一分鐘後再試。";break;case"de":e="Um die gleichen Daten nicht zu wiederholen, empfiehlt es sich, in einer Minute erneut zu versuchen.";break;case"en":e="To avoid duplicate submission of the same data, it is recommended that you try again in a minute.";break;case"es":e="Para evitar la repetición de los mismos datos, se recomienda intentarlo en un minuto.";break;case"fr":e="Pour éviter la répétition des mêmes données, il est recommandé que vous réessayez dans cinq minutes.";break;case"ja":e="同じデータが重複しないように、1分後に再試行することをおすすめします。";break;case"ko":e="같은 데이터가 반복되는 것을 피하기 위해서 1분 후에 다시 시도할 것을 건의합니다.";break;case"pt":e="Para evitar a submissão duplicada DOS mesmos dados, recomenda-se que você tente novamente EM um minuto.";break;case"ru":e=" во избежание повторения одних и тех же данных рекомендуется попробовать через минуту."}return e}()):"-5"==e.status?(a=s,e.stopDesc,b(a,"已停用！")):"-2"==e.status?b(s,i18nMap.captchasErrorPrompt):b(s,"操作失败")},error:function(){b(s,"操作失败！")}})};function g(p,d,u){var e=new Array,a=p.ITEM_LIST;if(null!=a&&"null"!=a&&""!=a){var c=p.i18nMap,t=p.DATA_TYPE,n=p.SUB_TYPE,i=p.compConfig;e=function(e,a,t,n,i,s){for(var o=new Array,l={},r={},p=0;p<e.length;p++){var d=e[p].item,u="item_"+d.id,c=d.fixedFlag,m=d.displayFlag;if(m){null==l[u]&&(l[u]={}),null==r[u]&&(r[u]={}),1==d.mustInputFlag?(l[u]={required:!0},r[u]={required:I(a.nullDefaultErrorPrompt,[d.name])}):0==d.mustInputFlag&&(l[u]={required:!1});var _="ErrorPrompt";0==c?_="i"+d.id+_:1==c&&(_=d.code+_);var f=a[_],v=d.maxLength;d.dataType==n.SINGLE_TEXT.ID?null==G(d.dataType,d.subType,n,i)&&(2==d.subType?(l[u].number=!0,r[u].number=C(d,f)):3==d.subType?(l[u].mobileValidate=!0,r[u].mobileValidate=C(d,f)):4==d.subType?(l[u].telPhoneValidate=!0,r[u].telPhoneValidate=C(d,f)):5==d.subType&&(l[u].email=!0,r[u].email=C(d,f)),y(r,l,u,v,f,a)):d.dataType==n.MULTI_TEXT.ID&&y(r,l,u,v,f,a)}}if(s.CaptchasBoxA+""=="true"){l.captchas={required:!0};var h=a.captchasTitle;r.captchas={required:I(a.nullDefaultErrorPrompt,[h])},l.captchas.validateCaptas=!0;var b=a.captchasErrorPrompt;r.captchas.validateCaptas=b}return o.push(l),o.push(r),o}(a,c,0,t,n,i);var m=k(".msgForm",d).formValidate(s,e[0],e[1]);d.off("click",".p_CommonBtnA"),d.on("click",".p_CommonBtnA",function(e){var a=k(".js_sendMessage_input",d),t=k(".js_sendMailMessage",d);console.log(a,"senSMS");var n=k(".p_sendBox",d),i=k(".p_mailBox",d);""==t.val()&&i.prev().find(".p_star").length?(i.find(".p_errBox").removeClass("item_hide").find(".font").text(c.captchasTips),i.find(".p_phoneMailCode").addClass("error")):(i.find(".p_errBox").addClass("item_hide"),i.find(".p_phoneMailCode").removeClass("error")),""==a.val()&&n.prev().find(".p_star").length?(n.find(".p_errBox").removeClass("item_hide").find(".font").text(c.captchasTips),n.find(".p_phoneCode").addClass("error")):(n.find(".p_errBox").addClass("item_hide"),n.find(".p_phoneCode").removeClass("error")),console.log(c,"smsmsmsmsms");var s=m.formSubmitCheck(),o=!0,l=p.compConfig.CaptchasBoxA;if("1"==d.find(".categoryCheckFlag").val()&&l+""=="true"&&(o=_(k(".js_captchas_input",d).val())),d.find(".p_sendBox").eq(0).is(":visible")&&d.find(".p_f11PhoneBox .p_star").length&&(o=f(k(".js_sendMessage_input",d).val(),d,"SMS",u)),d.find(".p_mailBox").is(":visible")&&d.find(".p_f11EmailBox .p_star").length&&(o=f(k(".js_sendMailMessage",d).val(),d,"EMAIL",u)),s&&o){var r=c.submitSucPrompt;v(r,d,p)}return k.fx.stop(),!1})}}function y(e,a,t,n,i,s){null!=e[t]&&"undefined"!=e[t]?null!=n&&null!=n&&""!=n&&(e[t].maxlength=I(s.maxlengthErrorPromt,[n])):(e[t]={required:i},null!=n&&null!=n&&""!=n&&(e[t]=I(s.maxlengthErrorPromt,[n]))),null!=n&&0!=n&&""!=n&&null!=n&&"null"!=n&&(null!=a[t]&&"undefined"!=a[t]?a[t].maxlength=n:a[t]={maxlength:n})}function I(e,a){if(!a||0==a.length)return e;for(var t=0;t<a.length;t++)e=e.replace(new RegExp("\\{"+t+"\\}","g"),a[t]);return e}function C(e,a){if(a&&""!=a)return a;var t="";return 0==e.fixedFlag&&1==e.dataType&&(2==e.subType?t=i18nMap.digitalSubTypeDefaultErrorPrompt:3==e.subType?t=i18nMap.mobileSubTypeDefaultErrorPrompt:4==e.subType?t=i18nMap.teleSubTypeDefaultErrorPrompt:5==e.subType&&(t=i18nMap.mailSubTypeDefaultErrorPrompt),t=I(t,[e.name])),t}function Y(e,a,t){var n=e[a];return n||(n=t),n}function D(e){var a="/captcha/get?date="+(new Date).getTime();k(".js_captchas_img",e).attr("src",a)}function E(e,a){return'<span class="i_'+e+'">'+a+"</span>"}return{init:function(e){e=this._params;var i,a,t,s,n,o,l,r,p,d,u,c=$compCl.getScope(e.id),m=k(".categoryUseFlag",c).val(),_=!0;if(_="0"!=k(".categoryCheckFlag",c).val(),"0"==m)d=k(".categoryStopDesc",o=c).val(),l="已停用",r=d,(p=[]).push('<div class="e_PromptDisabled e_PromptDisabled-001 p_promptDisabled">'),p.push('  <div class="promptbox">'),p.push('    <div class="prompt_title">'),p.push('    <i class="iconfont first"></i>'),p.push('    <div class="font"><i class="iconfont"></i>'+l+"</div>"),p.push("    </div>"),p.push('    <div class="prompt_content">'),p.push(r),p.push("    </div>"),p.push("  </div>"),p.push("</div>"),u=p.join(""),k(".p_MessageForm",o).append(u);else{var f=e.selectConfig;h(e.params,c,f,_),g(e.params,c,e),k("textarea",c).blur(function(){var e=k(this).attr("maxlength");e<k(this).val().length&&k(this).val(k(this).val().substring(0,e))}),D(n=c),k(".js_captchas_img_box",n).show(),k(".js_change_captchas_img",n).click(function(){D(n)}),a=e,t=k(".p_senSMSMessage",i=c),s={},t.off("click"),t.on("click",function(){if(k(this).hasClass("disables"))return!1;var e=k(this).parents(".p_sendBox").prev().find("input").val();if(console.log(e),e&&""!=e||k(this).hasClass("p_senMailessage"))if(e||""!=e||!k(this).hasClass("p_senMailessage")){s.compType=a.id,s.value=e,console.log(k(this).attr("class")),k(this).hasClass("p_senMailessage")?s.verifyType="EMAIL":s.verifyType="SMS";var n=k(this);k.ajax({url:"/memberverify/sendMessageVerify",type:"POST",data:s,async:!1,success:function(e){if(e=JSON.parse(e),console.log(e,"发送后回调数据"),2e3!=e.status)return b(i,e.i18Key),!1;var a=60;"SMS"==s.verifyType?i.find(".p_SMS").addClass("disables"):i.find(".p_senMailessage").addClass("disables"),n.next().removeClass("item_hide");var t=setInterval(function(){n.next().find("span").text(--a),a<0&&(a=60,i.find(".p_senSMSMessage").removeClass("disables"),n.next().addClass("item_hide"),n.next().find("span").text(a),clearInterval(t))},1e3)},error:function(e){console.log(e,"error")}})}else k(".p_f11EmailBox",i).find("input").trigger("blur");else k(".p_f11PhoneBox",i).find("input").trigger("blur")});var v=k(".categoryDesctiption").html();null!=k.trim(v)&&null!=k.trim(v)&&""!=k.trim(v)&&k.showRichText(c,e.id,"categoryDescContent",v),k(".d_DateIcon,.d_DateIconA").click(function(){k(this).prev().find("input").focus()}),"zh_CN"!=window.tenant.language&&"zh_HN"!=window.tenant.language||k(".p_phone input",c).attr("maxLength","20")}}}});